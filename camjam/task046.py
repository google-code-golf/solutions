def p(g,*h):
	d=h;i=[]
	for j in[*zip(*g),h]:
		if sum(j):d+=j,
		else:h=d=h and d and[[0,0,*j,0,0][2-h[-1].index(5)+d[0].index(5):][:3]for j in d]or d;i+=[[sum({*d[0]+d[1]}-{5})*(j>0)for j in j]for j in d];d=[]
	return[*zip(*i)]