p=lambda m,k=39:-k*m or p([[[v%(5|u^v%u),v<<(6%u>v),4|v%8][k+28>>5]for u,v in zip([8]+r,r)][::-1]for*r,in zip(*m)],k-1)
