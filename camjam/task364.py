import re
p=lambda m,k=47:-k*m or p(eval(re.sub(*([("(2|6), 1",r"\1,\1")]*9+["41",("0, 1(?=(, 1)+(, 0|\)))","0,6"),("(?<=[^0], [134])","%4+1")])[k//4],str([*zip(*m[::-1])]))),k-1)