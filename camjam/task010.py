p=lambda m,**d:[[r[x]and-~d.setdefault(x,len(d))for x in range(9)]for r in m]
# p=lambda m:[[v and 9-sorted(zip(*m)).index((*c,))for*c,v in zip(*m,r)]for r in m]