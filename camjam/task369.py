p=lambda m,k=7:-k*m or p([[v//5*5or[v-(v>u),u//5+~-v%3][k>3]for u,v in zip([5]+r,r)]for*r,in zip(*m[::-1])],k-1)
# TODO: pysearch