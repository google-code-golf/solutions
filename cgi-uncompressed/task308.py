def p(d):s=sum(d,[]);r=len(d[0]);*n,f=sorted((len(s)-s[::-1].index(n)-s.index(n),n)for n in {*s});e=n[-1][0]//r+1;s+=(d:=e*r*[f[1]]);[d:=[(d[n],o)[s[s.index(o)+n-(e*r-r+e-f)//2]==o]for n in range(e*r)]for f,o in n];return[d[n*r:][:e]for n in range(e)]