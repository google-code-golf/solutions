import re
p=lambda g,n=39:-n*g or p(eval(re.sub(*[r"(.),.0(?=[^)]*[1-9]) \1,\1",r"(0,.0,.)([^0]),.\1(.{%d})"%(3*len(g)-13)*2+r"(?!\1(\2|0)) *[\2]*5,\3\2,0,\1\2,\6"][n<4].split(),f"{*zip(*g[::-1]),}")),n-1)