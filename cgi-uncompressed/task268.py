import re
def p(g):v="12"[1in max(g)];return[g:=eval(re.sub(s[1]+f"(?={s[2:]}[^0])",s[0],f"{*zip(*g[::-1]),}"))for s in[v+"0(?<=[^0], 0)[^)]* "]*40+4*["40[0, ]*"+v]+27*[v+"0(.{%d}%s)+, "%(3*len(g)+4,v)]+["4"+v]][-1]