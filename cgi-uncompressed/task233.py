def p(r,l={}):
 for g in range(len(r)-2):
  for e in range(len(r[0])-2):
   i=*[r[g+n//3][e+n%3]==2for n in range(9)],
   if len(z:={r[g+n//3][e+n%3]for n in range(9)})>1>(0 in z):
    z={i:sum(z)-2}
    for n in range(9):r[g+n//3][e+n%3]=0;l[i]=z;i=*[i[2+n%3*3-n//3]for n in range(9)],
 r=[[*n]for n in zip(*r)if sum(n)]
 r=[[*n]for n in zip(*r)if sum(n)]
 for g in range(len(r)-2):
  for e in range(len(r[0])-2):
   i=*[r[g+n//3][e+n%3]==0for n in range(9)],
   if l.get(i,{}).get(i,{}):
    z=l.get(i,{}).pop(*l.get(i,{}))
    for n in range(9):r[g+n//3][e+n%3]=2>>r[g+n//3][e+n%3]or z
 for g in range(len(r)-2):
  for e in range(len(r[0])-2):
   i=*[r[g+n//3][e+n%3]==0for n in range(9)],
   if l.get(i,{}):
    z=l.get(i,{}).pop(*l.get(i,{}))
    for n in range(9):r[g+n//3][e+n%3]=2>>r[g+n//3][e+n%3]or z
 return r