p=lambda g,n=3:-n*g or p([*zip(*[[k*l%7for k in i for l in j]for i in(8in g[0]+g[1])*g[len(g[0]):]for j in g[:len(i)]]or g)][::-1],n-1)