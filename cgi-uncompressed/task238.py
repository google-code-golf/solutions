def p(p):
 i=p
 for n in p*4:i=[p for*p,in zip(*i)if 8in p];p=[p for*p,in zip(*p)if{*p}-{8,0}]
 for n in p[1:-1]:n[1:-1]=i.pop(0)
 for n in p*4:i=0;p=[[n%~n&p[0]for n in p[:d]]+p[d:]for*p,in zip(*p[::-1])if[d:=min(i,len(p)-(i:=i+1))]]
 return p