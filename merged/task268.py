import re
p=lambda g,i=7:-i*g or p(eval(re.sub("0(?=%s)"%["(.%r0)*, [^0].%%r[^0], 4"%{o:=len(g)*3+4}%{o-6},r"[0, ]++(.).{,3}\).*#.*\1, \1, [0, ]+\1"][i>3],"4",f'{*zip(*g),}#{g}'))[::-1],i-1)