p=lambda g,i=0:sum(a:=eval("(g:=[[*map(max,*x)]for x in zip(g,([*zip(*(g*2)[i%21::-1])]*i)[i:])]),"*3)[2],a).count(0)//87*a or p(g,i+1)