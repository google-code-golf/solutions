p=lambda g,i=11,k=0:-i*g or[[c*(k:=b|(1in r))or(sum(map(bool,r))-b>2>i%6)*2for c in r]for r in zip(*p(g,i-1)[::-1])if[b:=k]]