p=lambda g,i=47:g*-i or[[[3&q%~(c:=r.pop())%5|2&q*-(8in r),~c*q%2*9,c&10][8>>13-i//4]or c for q in[0]+r[:0:-1]]for*r,in zip(*p(g,i-1))]