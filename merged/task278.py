p=lambda m,k=11:-k*m or p([[[v%9,v|3%-~u,v<<u][k>>2]for u,v in zip([0]+r,r)]for*r,in zip(*m[::-1])],k-1)