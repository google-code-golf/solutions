p=lambda g:[g:=[[a]*-~(C:=a in r*a)+[c*(c in g[-1]+g[1])for c in r[C:]]for a,*r in zip(*g)][::-1]for _ in g][3]