p=lambda g,k=3:g*-k or[[k:=[c:=r.pop(),k][[0,*r][-1]in[k,0]*c]for _ in r*1]for*r,in zip(*p(g,k-1))]