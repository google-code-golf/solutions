p=lambda g,i=6:g*(i<3)or p([[(d:=r.pop()or[0,*r][-1]*i)>>5*(d>6>4>i)for r in g]for _ in g],i-1)