p=lambda g,k=87:-k*[[min(e+u,key=e.count)for*u,in zip(*g)]for*e,in g]or p([*zip(*g)][sum(u[:6].count(u[0])>4for u in g)<6:][::-1],k-1)