p=lambda g:exec("m=max(g)\nfor x in-2%len({*m})*b'osqmnr':(l,c),*_,r=filter(min,enumerate(m,1));s=l-2+r[0]>>1;m[l:s]=-l%s*[c];g[g.index(m)+x%5-2][s-x%2]=c\ng[:]=[y[::-1]for*y,in zip(*g)];"*4)or g