p=lambda y,f=15:-f*y or[(h:=lambda y,i,e,o,a:len(y)>(r:=i+o)>1<max(a.count(y[i][e])for a in zip(y[r][e:e+a],[*y[r][e+1:],0],y[r-1][e:])),exec("a=o=1"+";o+=h(y,i,e,o,a);a+=h([*zip(*y)],e,i,a,o)\nfor r in y[i:i+o]:\n for J in range(a):r[e-1-J]|=r[e+J]//y[i][e]*y[i][e-1]"*3))for i in range(len(y))for e in range(len(y))if 0<y[i][e]!=y[i][e-1]]and p([*map(list,zip(*y))][::f%4<1or-1],f-1)