p=lambda m,k=7:-k*m or p([[-(k//7-9&r.pop()*~u)//5for u in[0]+r[:0:-1]]for*r,in zip(*m)],k-1)
# TODO: pysearch