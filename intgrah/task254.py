p=lambda m:[*zip(*map(lambda*c:[-v&(c==max(z:={*zip(*m)}))+2*(c<sorted(z)[2])for v in c],*m))]
# p=lambda m:[*zip(*map(lambda*c:[-v&(c>(z:=sorted({*zip(*m)}))[-2])+2*(c<z[2])for v in c],*m))]