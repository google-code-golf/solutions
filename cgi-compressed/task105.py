p=lambda g,n=-3,i=0:g*n or p([[P:=r.pop()or any(r*P+c)<<i&2for c in g[::-1]]for*r,in zip(*g)if[i:=sorted(r)[P:=-4]or i*2+any(r)]],n+1)