def p(m):f,b=sorted([m[:len(m)//2],[m[:len(m)//2]for m in m],m[len(m)//2:],[m[len(m)//2:]for m in m]][len(m)<len(m[0])::2],key=lambda m:len({*sum(m,[])}));*o,o,a=sorted({*sum(m,[])},key=sum(b,[]).count);return[[1for l in b[l:l+n]for l[t:t+r]in[[a]*r]]and[[1for d in range(n)for f[l+d][t:t+r]in[e[d]]]for l in range(len(f)-n+1)for t in range(len(f[0])-r+1)if all([[[l,sorted({*sum(m,[])},key=sum(f,[]).count)[-1]][l==o]for l in e[d]]==f[l+d][t:t+r]for d in range(n)])]for c in range(7,0,-1)for n in range(7,0,-1)for r in range(7,0,-1)for l in range(len(f)-n+1)for t in range(len(f[0])-r+1)if a not in sum(e:=[l[t:t+r]for l in b[l:l+n]],[])and~-c<n*r-sum(e,[]).count(o)]and f