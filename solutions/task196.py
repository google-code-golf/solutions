p=lambda g,i=19:g*-i or[*map(lambda*r,q=8:[q:=[c|8-c&q,c|-c&~q%3,c%4][i//8]for c in r],*p(g,i-1)[::-1])]
# ----------------------------------------------------------------
# post-comp-diamonds
