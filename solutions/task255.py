import re;p=lambda g,k=9:eval(re.sub(*["\((%s|(0, )+3.{5}3,)"%re.search("([ ,03]{61,})(.*\\1){3}|$",g:=f'{*zip(*~k*g or p(g,k-1)),}')[1],"(?=0, [^0])","(*[3]*len([\\1]),","1<"][k<2::2],g))[::-1]
# ----------------------------------------------------------------
# post-comp-diamonds

import re;p=lambda g,k=9:eval(re.sub(*["\((%s|(0, )+3.{5}3),?"%re.search(r"([ ,03]{61,})(.*\1){3}|$",g:=f'{*zip(*~k*g or p(g,k-1)),}')[1],"(?=0((,[^,]*){31}|, )[1-9])",r"(*[3]*len([\1]),","1<"][k<2::2],g))[::-1]
# ----------------------------------------------------------------
# post-comp-diamonds
