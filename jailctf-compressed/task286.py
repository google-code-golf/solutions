p=lambda g,i=-271:g*i or[[r.pop()or sum({*p%8*sum(g,[-p-8])})for p in[0]+r[:0:-1]]for*r,in zip(*p(g,i+1))]