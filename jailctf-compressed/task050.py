p=lambda g,x=0:[[c|((x:=~sum(r)&c^x)>6>c)*3for c in r]for*r,in zip(*x*g or p(g,1))]