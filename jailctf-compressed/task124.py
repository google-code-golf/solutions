p=lambda g:g[9:]and g or p(g+[(~-((x:=g[1])in g[3:])*~(x>g[3][1:]+x)*[0]+g[-2-(x==g[4])])[:10]])