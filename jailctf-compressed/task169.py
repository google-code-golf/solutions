p=lambda g,k=-11,i=1:k*g or[[c%~c&(i:=[i*8,5-c%7,c|i&c%~c][k//8])for c in[0]+r][:0:-1]for*r,in zip(*p(g,k+1))]